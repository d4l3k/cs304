# CPSC 304 - Tutorial 3 Relational Algebra
Tristan Rice, 25886145, q7w9a

## Question 1. Consider a database consisting of the relations, where the primary Key of each relation is in boldface.

customer (*cid*, cname, rating, salary).

order (*cid*, *iid*, *day*, qty).

item (*iid*, iname, type, price).

### (a) Express the following query in RA “Find the details (i.e., all attributes) of the customers who have a rating higher than 6 and earn less than $125,000.”

$$\ro_{rating > 5, salary < 125000}(customer)$$

### (b) Express the following query in RA “Find the various item names and their types.”

$$\pi_{iname, type}(item)$$

### (c) Consider the query $$\pi_{iid, price}(item)$$. Suppose $$item$$ has 1000 tuples. Then how many tuples will the result of the above projection query contain? Explain your answer.

There will be 1000 tuples, since every row in the item array has a iid and a
price.


###(d) Express the following query in RA. “Find the type and name of those items, whose price is at most $100 OR which were ordered by the customer with cid=123.”

$$\pi_{iname,type}(\ro_{price < 100 or cid=123}(item \leftouterjoin_{item.iid = order.cid} order))$$

### (e) Express the following query in RA. “Find the names of customers who did not order any laptop, i.e., did not order any item of type laptop”.

$$\pi_{cname}(customers - (customer \join_{customer.cid = order.cid, item.type = "laptop"} (order \join_{order.iid == item.iid} item)$$

## Question 2. Consider a database consisting of the relations, where the primary key of each relation is in boldface.

sailors (*sid*, sname, rating, age)

boats (*bid*, bname, color)

reserved (*sid*, *bid*, date)

Write the following queries in RA.

### (a) Find the names of sailors who have reserved at least two different boats with the same color.

$$ reserved \join_{reserved.bid = boats.bid} boats$$

### (b) Find the names of sailors who have reserved all red boats.

### (c) Find the name and color of boats which are reserved by all sailors rated above 7.

### (d) Find the name(s) of sailors with the lowest rating.

### (e) Find the name and rating of the oldest sailor(s).

### (f) Find the names of sailors who have reserved every boat reserved by those with a lower rating.  E.g., if Bob is a sailor rated at 6, Pete and Rick are sailors rated below 6, then Bob must have reserved every boat reserved by Pete as well as those reserved by Rick.

#### Can you express this query using RA’s division operator? Explain your answer.
